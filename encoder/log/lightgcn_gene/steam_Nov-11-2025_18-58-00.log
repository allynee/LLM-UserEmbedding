2025-11-11 18:58:00,735 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': True, 'loss': 'pairwise', 'log_loss': False, 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'steam', 'user_num': 23310, 'item_num': 5237}, 'model': {'name': 'lightgcn_gene', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 3, 'reg_weight': 1e-07, 'mask_ratio': 0.1, 'recon_weight': 0.1, 're_temperature': 0.2, 'amazon': {'layer_num': 2, 'reg_weight': 1e-07, 'mask_ratio': 0.15, 'recon_weight': 0.1, 're_temperature': 0.5}, 'yelp': {'layer_num': 2, 'reg_weight': 1e-07, 'mask_ratio': 0.05, 'recon_weight': 0.01, 're_temperature': 0.1}, 'steam': {'layer_num': 2, 'reg_weight': 1e-06, 'mask_ratio': 0.15, 'recon_weight': 0.1, 're_temperature': 0.5}}}
2025-11-11 18:58:20,135 - Epoch   0 Validation set [recall@5: 0.0351 recall@10: 0.0555 recall@20: 0.0908 ] [ndcg@5: 0.0413 ndcg@10: 0.0472 ndcg@20: 0.0586 ] 
2025-11-11 18:59:01,535 - Epoch   3 Validation set [recall@5: 0.0353 recall@10: 0.0559 recall@20: 0.0917 ] [ndcg@5: 0.0414 ndcg@10: 0.0471 ndcg@20: 0.0587 ] 
2025-11-11 18:59:41,379 - Epoch   6 Validation set [recall@5: 0.0354 recall@10: 0.0564 recall@20: 0.0920 ] [ndcg@5: 0.0419 ndcg@10: 0.0479 ndcg@20: 0.0594 ] 
2025-11-11 19:00:21,628 - Epoch   9 Validation set [recall@5: 0.0352 recall@10: 0.0585 recall@20: 0.0941 ] [ndcg@5: 0.0418 ndcg@10: 0.0490 ndcg@20: 0.0606 ] 
2025-11-11 19:01:02,696 - Epoch  12 Validation set [recall@5: 0.0361 recall@10: 0.0618 recall@20: 0.0991 ] [ndcg@5: 0.0427 ndcg@10: 0.0509 ndcg@20: 0.0631 ] 
2025-11-11 19:01:43,284 - Epoch  15 Validation set [recall@5: 0.0381 recall@10: 0.0650 recall@20: 0.1045 ] [ndcg@5: 0.0446 ndcg@10: 0.0531 ndcg@20: 0.0662 ] 
2025-11-11 19:02:24,570 - Epoch  18 Validation set [recall@5: 0.0405 recall@10: 0.0666 recall@20: 0.1085 ] [ndcg@5: 0.0469 ndcg@10: 0.0549 ndcg@20: 0.0689 ] 
2025-11-11 19:03:05,181 - Epoch  21 Validation set [recall@5: 0.0424 recall@10: 0.0699 recall@20: 0.1140 ] [ndcg@5: 0.0492 ndcg@10: 0.0576 ndcg@20: 0.0723 ] 
2025-11-11 19:03:47,039 - Epoch  24 Validation set [recall@5: 0.0437 recall@10: 0.0727 recall@20: 0.1190 ] [ndcg@5: 0.0506 ndcg@10: 0.0598 ndcg@20: 0.0752 ] 
2025-11-11 19:04:29,487 - Epoch  27 Validation set [recall@5: 0.0454 recall@10: 0.0761 recall@20: 0.1222 ] [ndcg@5: 0.0526 ndcg@10: 0.0622 ndcg@20: 0.0777 ] 
2025-11-11 19:05:10,156 - Epoch  30 Validation set [recall@5: 0.0469 recall@10: 0.0785 recall@20: 0.1247 ] [ndcg@5: 0.0540 ndcg@10: 0.0640 ndcg@20: 0.0795 ] 
2025-11-11 19:05:49,010 - Epoch  33 Validation set [recall@5: 0.0482 recall@10: 0.0805 recall@20: 0.1278 ] [ndcg@5: 0.0551 ndcg@10: 0.0655 ndcg@20: 0.0813 ] 
2025-11-11 19:06:29,217 - Epoch  36 Validation set [recall@5: 0.0493 recall@10: 0.0824 recall@20: 0.1301 ] [ndcg@5: 0.0561 ndcg@10: 0.0668 ndcg@20: 0.0827 ] 
2025-11-11 19:07:12,299 - Epoch  39 Validation set [recall@5: 0.0502 recall@10: 0.0835 recall@20: 0.1323 ] [ndcg@5: 0.0571 ndcg@10: 0.0677 ndcg@20: 0.0840 ] 
2025-11-11 19:07:52,286 - Epoch  42 Validation set [recall@5: 0.0506 recall@10: 0.0846 recall@20: 0.1342 ] [ndcg@5: 0.0574 ndcg@10: 0.0683 ndcg@20: 0.0849 ] 
2025-11-11 19:08:32,833 - Epoch  45 Validation set [recall@5: 0.0513 recall@10: 0.0854 recall@20: 0.1360 ] [ndcg@5: 0.0580 ndcg@10: 0.0691 ndcg@20: 0.0861 ] 
2025-11-11 19:09:13,855 - Epoch  48 Validation set [recall@5: 0.0526 recall@10: 0.0856 recall@20: 0.1369 ] [ndcg@5: 0.0589 ndcg@10: 0.0696 ndcg@20: 0.0868 ] 
2025-11-11 19:09:55,248 - Epoch  51 Validation set [recall@5: 0.0531 recall@10: 0.0871 recall@20: 0.1382 ] [ndcg@5: 0.0595 ndcg@10: 0.0705 ndcg@20: 0.0876 ] 
2025-11-11 19:10:38,112 - Epoch  54 Validation set [recall@5: 0.0534 recall@10: 0.0877 recall@20: 0.1396 ] [ndcg@5: 0.0599 ndcg@10: 0.0711 ndcg@20: 0.0885 ] 
2025-11-11 19:11:17,846 - Epoch  57 Validation set [recall@5: 0.0536 recall@10: 0.0885 recall@20: 0.1402 ] [ndcg@5: 0.0603 ndcg@10: 0.0717 ndcg@20: 0.0890 ] 
2025-11-11 19:11:58,098 - Epoch  60 Validation set [recall@5: 0.0544 recall@10: 0.0892 recall@20: 0.1411 ] [ndcg@5: 0.0607 ndcg@10: 0.0720 ndcg@20: 0.0895 ] 
2025-11-11 19:12:37,446 - Epoch  63 Validation set [recall@5: 0.0539 recall@10: 0.0898 recall@20: 0.1417 ] [ndcg@5: 0.0605 ndcg@10: 0.0723 ndcg@20: 0.0897 ] 
2025-11-11 19:13:18,588 - Epoch  66 Validation set [recall@5: 0.0542 recall@10: 0.0903 recall@20: 0.1424 ] [ndcg@5: 0.0610 ndcg@10: 0.0729 ndcg@20: 0.0903 ] 
2025-11-11 19:13:52,078 - Epoch  69 Validation set [recall@5: 0.0548 recall@10: 0.0903 recall@20: 0.1428 ] [ndcg@5: 0.0613 ndcg@10: 0.0729 ndcg@20: 0.0905 ] 
2025-11-11 19:14:25,885 - Epoch  72 Validation set [recall@5: 0.0549 recall@10: 0.0907 recall@20: 0.1435 ] [ndcg@5: 0.0615 ndcg@10: 0.0732 ndcg@20: 0.0910 ] 
2025-11-11 19:14:58,888 - Epoch  75 Validation set [recall@5: 0.0553 recall@10: 0.0909 recall@20: 0.1442 ] [ndcg@5: 0.0619 ndcg@10: 0.0736 ndcg@20: 0.0915 ] 
2025-11-11 19:15:34,568 - Epoch  78 Validation set [recall@5: 0.0564 recall@10: 0.0916 recall@20: 0.1440 ] [ndcg@5: 0.0624 ndcg@10: 0.0739 ndcg@20: 0.0915 ] 
2025-11-11 19:16:09,188 - Epoch  81 Validation set [recall@5: 0.0564 recall@10: 0.0914 recall@20: 0.1442 ] [ndcg@5: 0.0623 ndcg@10: 0.0738 ndcg@20: 0.0916 ] 
2025-11-11 19:16:43,795 - Epoch  84 Validation set [recall@5: 0.0562 recall@10: 0.0917 recall@20: 0.1444 ] [ndcg@5: 0.0626 ndcg@10: 0.0742 ndcg@20: 0.0919 ] 
2025-11-11 19:17:17,289 - Epoch  87 Validation set [recall@5: 0.0561 recall@10: 0.0916 recall@20: 0.1448 ] [ndcg@5: 0.0625 ndcg@10: 0.0741 ndcg@20: 0.0919 ] 
2025-11-11 19:17:52,394 - Epoch  90 Validation set [recall@5: 0.0563 recall@10: 0.0921 recall@20: 0.1448 ] [ndcg@5: 0.0627 ndcg@10: 0.0744 ndcg@20: 0.0921 ] 
2025-11-11 19:18:13,928 - Epoch  93 Validation set [recall@5: 0.0565 recall@10: 0.0924 recall@20: 0.1452 ] [ndcg@5: 0.0626 ndcg@10: 0.0745 ndcg@20: 0.0922 ] 
2025-11-11 19:18:35,380 - Epoch  96 Validation set [recall@5: 0.0565 recall@10: 0.0925 recall@20: 0.1454 ] [ndcg@5: 0.0627 ndcg@10: 0.0746 ndcg@20: 0.0924 ] 
2025-11-11 19:18:56,433 - Epoch  99 Validation set [recall@5: 0.0566 recall@10: 0.0926 recall@20: 0.1451 ] [ndcg@5: 0.0627 ndcg@10: 0.0746 ndcg@20: 0.0923 ] 
2025-11-11 19:19:17,797 - Epoch 102 Validation set [recall@5: 0.0566 recall@10: 0.0920 recall@20: 0.1457 ] [ndcg@5: 0.0626 ndcg@10: 0.0743 ndcg@20: 0.0923 ] 
2025-11-11 19:19:38,756 - Epoch 105 Validation set [recall@5: 0.0563 recall@10: 0.0924 recall@20: 0.1455 ] [ndcg@5: 0.0624 ndcg@10: 0.0743 ndcg@20: 0.0922 ] 
2025-11-11 19:20:00,107 - Epoch 108 Validation set [recall@5: 0.0563 recall@10: 0.0923 recall@20: 0.1452 ] [ndcg@5: 0.0624 ndcg@10: 0.0743 ndcg@20: 0.0922 ] 
2025-11-11 19:20:21,103 - Epoch 111 Validation set [recall@5: 0.0560 recall@10: 0.0929 recall@20: 0.1460 ] [ndcg@5: 0.0623 ndcg@10: 0.0745 ndcg@20: 0.0924 ] 
2025-11-11 19:20:42,445 - Epoch 114 Validation set [recall@5: 0.0561 recall@10: 0.0921 recall@20: 0.1460 ] [ndcg@5: 0.0624 ndcg@10: 0.0743 ndcg@20: 0.0925 ] 
2025-11-11 19:21:03,428 - Epoch 117 Validation set [recall@5: 0.0563 recall@10: 0.0925 recall@20: 0.1463 ] [ndcg@5: 0.0624 ndcg@10: 0.0744 ndcg@20: 0.0926 ] 
2025-11-11 19:21:24,783 - Epoch 120 Validation set [recall@5: 0.0564 recall@10: 0.0922 recall@20: 0.1467 ] [ndcg@5: 0.0624 ndcg@10: 0.0743 ndcg@20: 0.0926 ] 
2025-11-11 19:21:45,764 - Epoch 123 Validation set [recall@5: 0.0568 recall@10: 0.0928 recall@20: 0.1461 ] [ndcg@5: 0.0625 ndcg@10: 0.0745 ndcg@20: 0.0924 ] 
2025-11-11 19:22:07,093 - Epoch 126 Validation set [recall@5: 0.0569 recall@10: 0.0923 recall@20: 0.1460 ] [ndcg@5: 0.0625 ndcg@10: 0.0742 ndcg@20: 0.0923 ] 
2025-11-11 19:22:28,047 - Epoch 129 Validation set [recall@5: 0.0570 recall@10: 0.0920 recall@20: 0.1460 ] [ndcg@5: 0.0628 ndcg@10: 0.0743 ndcg@20: 0.0925 ] 
2025-11-11 19:22:49,485 - Epoch 132 Validation set [recall@5: 0.0573 recall@10: 0.0924 recall@20: 0.1459 ] [ndcg@5: 0.0627 ndcg@10: 0.0744 ndcg@20: 0.0924 ] 
2025-11-11 19:23:10,629 - Epoch 135 Validation set [recall@5: 0.0572 recall@10: 0.0921 recall@20: 0.1451 ] [ndcg@5: 0.0626 ndcg@10: 0.0741 ndcg@20: 0.0920 ] 
2025-11-11 19:23:13,863 - [recall@5: 0.0564 recall@10: 0.0922 recall@20: 0.1467 ] [ndcg@5: 0.0624 ndcg@10: 0.0743 ndcg@20: 0.0926 ] 
2025-11-11 19:23:17,220 - [recall@5: 0.0546 recall@10: 0.0906 recall@20: 0.1447 ] [ndcg@5: 0.0602 ndcg@10: 0.0725 ndcg@20: 0.0908 ] 
2025-11-11 19:23:17,231 - Save model parameters to ./encoder/checkpoint/lightgcn_gene/lightgcn_gene-steam-2023.pth
2025-11-11 19:23:17,231 - Best Epoch 120. Final test result: {'recall': array([0.05461864, 0.09061568, 0.14471614]), 'ndcg': array([0.0601974 , 0.07251954, 0.09080767])}.
